<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>THE SONGA - Community Feed</title>
    <!-- Preconnect to critical domains -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://www.gstatic.com">
    <link rel="preconnect" href="https://i.postimg.cc">
    <link rel="preconnect" href="https://accounts.google.com">
    
    <!-- Preload critical resources -->
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="icon" type="image/x-icon" href="https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Inline critical CSS -->
    <style>
        /* RESET AND BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --gold: #D4AF37;
            --gold-light: #F5E6B3;
            --gold-dark: #B8860B;
            --black: #000000;
            --white: #ffffff;
            --gray: #f5f5f5;
            --dark-gray: #666666;
            --light-gray: #e5e5e5;
            --accent: #25D366;
            --comment-bg: #f8f9fa;
            --reply-bg: #f0f2f5;
            --shadow: rgba(0, 0, 0, 0.1);
            --modal-overlay: rgba(0, 0, 0, 0.92);
            --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            --hover-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --background: #fafafa;
            --success: #2ecc71;
            --error: #e74c3c;
            --info: #3498db;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            background-color: var(--background);
            color: var(--black);
            line-height: 1.5;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            padding-bottom: 80px;
            min-height: 100vh;
        }

        body.modal-open {
            overflow: hidden;
            height: 100vh;
        }

        /* SESSION STATUS */
        .session-status {
            position: fixed;
            top: 80px;
            right: 10px;
            background: var(--gold);
            color: var(--black);
            padding: 8px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 9999;
            display: none;
            align-items: center;
            gap: 6px;
            box-shadow: 0 3px 10px rgba(212, 175, 55, 0.3);
            max-width: 200px;
            animation: slideIn 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .session-status.visible {
            display: flex;
        }
        
        .session-status.restored {
            background: #2ecc71;
            color: white;
        }

        /* BACK TO TOP BUTTON */
        .back-to-top {
            position: fixed;
            bottom: 90px;
            right: 16px;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--black);
            cursor: pointer;
            z-index: 98;
            box-shadow: 0 3px 12px rgba(212, 175, 55, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
            visibility: hidden;
            border: none;
        }

        .back-to-top.visible {
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        /* BOTTOM NAVIGATION */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--white);
            display: flex;
            justify-content: space-around;
            padding: 0.5rem 0;
            z-index: 100;
            border-top: 1px solid var(--light-gray);
            backdrop-filter: blur(20px);
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            transform: translateY(0);
        }

        .bottom-nav.hidden {
            transform: translateY(100%);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--dark-gray);
            text-decoration: none;
            font-size: 0.7rem;
            transition: all 0.3s ease;
            position: relative;
            padding: 6px 12px;
            border-radius: 12px;
            min-width: 56px;
        }

        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 2px;
        }

        .nav-item.active {
            color: var(--gold-dark);
            background: var(--gold-light);
            font-weight: 700;
        }

        .nav-item:hover {
            color: var(--gold-dark);
        }

        /* CREATE POST BUTTON */
        .create-post-btn {
            position: fixed;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
            border: none;
            width: 52px;
            height: 52px;
            border-radius: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 99;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            transition: all 0.3s ease;
            font-size: 1.3rem;
            display: none;
        }

        .create-post-btn:hover {
            transform: translateX(-50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        /* HEADER */
        header {
            background-color: var(--white);
            color: var(--black);
            padding: 0.5rem 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            height: 56px;
            backdrop-filter: blur(20px);
            border-bottom: none;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
            max-width: 100%;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            text-decoration: none;
            min-width: 0;
            flex-shrink: 0;
        }

        .logo img {
            height: 36px;
            width: 36px;
            border-radius: 10px;
            object-fit: cover;
        }

        .brand-info {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .brand-name {
            font-weight: 800;
            font-size: 1rem;
            color: var(--gold-dark);
            letter-spacing: -0.3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .brand-subtitle {
            font-size: 0.6rem;
            color: var(--dark-gray);
            font-style: italic;
            letter-spacing: 0.5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* USER PROFILE */
        .auth-section {
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 1.1rem;
            padding: 6px;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none;
        }

        .notification-btn:hover {
            background: var(--gray);
            color: var(--gold-dark);
        }

        .notification-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 16px;
            height: 16px;
            background: #e74c3c;
            border-radius: 50%;
            border: 2px solid var(--white);
            color: white;
            font-size: 0.6rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            border-radius: 20px;
            background: var(--gold-light);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            min-width: 0;
            display: none;
        }

        .user-profile:hover {
            background: var(--gold);
            border-color: var(--gold-dark);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--gold);
            flex-shrink: 0;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--black);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 80px;
        }

        .user-dropdown {
            position: fixed;
            top: 60px;
            right: 10px;
            background: var(--white);
            border-radius: 16px;
            box-shadow: 0 8px 30px var(--shadow);
            min-width: 180px;
            z-index: 1000;
            display: none;
            overflow: hidden;
            border: 1px solid var(--light-gray);
            animation: slideDown 0.2s ease;
            max-width: calc(100vw - 20px);
        }

        .user-dropdown.active {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .dropdown-item {
            padding: 14px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid var(--light-gray);
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background-color: var(--gold-light);
            color: var(--black);
        }

        .dropdown-item i {
            width: 18px;
            text-align: center;
            color: var(--gold-dark);
            font-size: 0.95rem;
            flex-shrink: 0;
        }

        /* MAIN CONTENT */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0.75rem 1rem;
            padding-bottom: 1rem;
        }

        /* COMMUNITY POSTS */
        .community-posts {
            margin: 0.5rem 0;
        }

        .posts-header {
            margin-bottom: 1.5rem;
            padding: 0.5rem 0;
        }

        .posts-title {
            font-size: 1.5rem;
            color: var(--black);
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: -0.5px;
            flex-wrap: wrap;
            row-gap: 8px;
        }

        .inner-circle-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 0;
            vertical-align: middle;
            white-space: nowrap;
        }

        .new-posts-indicator {
            background: var(--gold);
            color: var(--black);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 700;
            animation: pulse 2s infinite;
            cursor: pointer;
            display: none;
            box-shadow: 0 3px 10px rgba(212, 175, 55, 0.3);
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .new-posts-indicator:hover {
            transform: scale(1.05);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .posts-header p {
            margin-top: 8px;
            color: var(--dark-gray);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* CATEGORIES FILTER */
        .categories-filter {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0 1.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            padding-right: 1rem;
        }

        .categories-filter::-webkit-scrollbar {
            display: none;
        }

        .category-filter-btn {
            padding: 6px 14px;
            border: 1.5px solid var(--light-gray);
            border-radius: 16px;
            background: white;
            color: var(--dark-gray);
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .category-filter-btn:hover {
            border-color: var(--gold);
            color: var(--gold-dark);
        }

        .category-filter-btn.active {
            background: var(--gold);
            color: var(--black);
            border-color: var(--gold);
        }

        /* POST CARD */
        .post-card {
            background: var(--white);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            position: relative;
            border: none;
            overflow: hidden;
        }

        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }

        .post-card.pinned {
            border-left: 3px solid var(--gold);
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
        }

        .pinned-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--gold-dark);
            font-size: 0.75rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .pinned-indicator i {
            color: var(--gold);
            font-size: 0.9rem;
        }

        /* POST HEADER */
        .post-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 1rem;
            position: relative;
            flex-wrap: wrap;
        }

        .post-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--gold);
            cursor: pointer;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .post-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .post-author-info {
            flex: 1;
            min-width: 0;
            max-width: calc(100% - 56px);
        }

        .post-author {
            font-weight: 700;
            color: var(--black);
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 2px;
            flex-wrap: wrap;
            row-gap: 4px;
        }

        /* POST TYPE INDICATOR */
        .post-type-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.65rem;
            font-weight: 700;
            margin-left: 0;
            vertical-align: middle;
            white-space: nowrap;
        }

        .post-time {
            font-size: 0.75rem;
            color: var(--dark-gray);
            display: flex;
            align-items: center;
            gap: 4px;
            flex-wrap: wrap;
        }

        .post-views {
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .real-time-update {
            animation: highlightUpdate 1s ease;
        }

        @keyframes highlightUpdate {
            0% { background-color: rgba(212, 175, 55, 0.2); }
            100% { background-color: transparent; }
        }

        /* FOLLOW BUTTON */
        .follow-btn-container {
            display: flex;
            align-items: center;
            gap: 6px;
            position: absolute;
            top: 0;
            right: 0;
            max-width: 120px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .follow-btn {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
            border: none;
            padding: 4px 12px;
            border-radius: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
            height: 26px;
            min-width: 60px;
        }

        .follow-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(212, 175, 55, 0.3);
        }

        .follow-btn.following {
            background: var(--light-gray);
            color: var(--dark-gray);
            min-width: 70px;
        }

        .follow-btn.following:hover {
            background: #e74c3c;
            color: white;
        }

        /* FOLLOWER COUNT */
        .follower-count {
            background: var(--gold-light);
            color: var(--gold-dark);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 3px;
            white-space: nowrap;
            height: 26px;
            min-width: 40px;
            justify-content: center;
        }

        .follower-count i {
            font-size: 0.65rem;
        }

        /* POST OPTIONS */
        .post-options {
            position: absolute;
            top: 0;
            right: 0;
        }

        .post-options-btn {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            padding: 6px;
            border-radius: 50%;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .post-options-btn:hover {
            background: var(--gray);
            color: var(--gold-dark);
        }

        .post-options-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            background: var(--white);
            border-radius: 14px;
            box-shadow: 0 8px 25px var(--shadow);
            min-width: 160px;
            z-index: 1000;
            display: none;
            overflow: hidden;
            border: 1px solid var(--light-gray);
            animation: slideDown 0.2s ease;
        }

        .post-options-dropdown.active {
            display: block;
        }

        .post-option-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid var(--light-gray);
            font-size: 0.85rem;
            color: var(--dark-gray);
        }

        .post-option-item:last-child {
            border-bottom: none;
        }

        .post-option-item:hover {
            background-color: var(--gold-light);
            color: var(--black);
        }

        .post-option-item.delete {
            color: #e74c3c;
        }

        .post-option-item.delete:hover {
            background-color: rgba(231, 76, 60, 0.1);
        }

        .post-option-item i {
            width: 18px;
            text-align: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        /* POST CONTENT */
        .post-content {
            margin-bottom: 1.25rem;
            line-height: 1.5;
        }

        .post-content h3 {
            color: var(--black);
            margin-bottom: 0.75rem;
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: -0.2px;
            line-height: 1.3;
        }

        .post-content p {
            margin-bottom: 1rem;
            white-space: pre-line;
            font-size: 0.95rem;
            color: var(--dark-gray);
            line-height: 1.5;
        }

        .post-media {
            width: 100%;
            border-radius: 12px;
            margin: 1rem 0;
            overflow: hidden;
            cursor: pointer;
            position: relative;
        }

        .post-media img {
            width: 100%;
            height: auto;
            border-radius: 12px;
            max-height: 300px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .post-media:hover img {
            transform: scale(1.03);
        }

        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin: 1rem 0;
        }

        .post-tag {
            background: var(--gold-light);
            color: var(--gold-dark);
            padding: 4px 10px;
            border-radius: 14px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            white-space: nowrap;
        }

        .post-tag:hover {
            background: var(--gold);
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(212, 175, 55, 0.2);
        }

        /* POST ACTIONS */
        .post-actions {
            display: flex;
            gap: 0.25rem;
            padding-top: 1rem;
            margin-top: 1rem;
            border-top: 1px solid var(--light-gray);
        }

        .post-action {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 10px;
            font-weight: 600;
            flex: 1;
            justify-content: center;
            font-size: 0.85rem;
            min-height: 40px;
        }

        .post-action:hover {
            background: var(--gray);
            color: var(--gold-dark);
            transform: translateY(-1px);
        }

        .post-action.liked {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .post-action.saved {
            color: var(--gold-dark);
            background: rgba(212, 175, 55, 0.1);
        }

        .post-action.active {
            background: var(--gold-light);
            color: var(--gold-dark);
        }

        .post-action i {
            font-size: 1rem;
        }

        .post-action span {
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        /* POST INSIGHTS */
        .post-insights {
            margin-top: 1rem;
            padding: 0.75rem;
            background: var(--gray);
            border-radius: 12px;
            display: none;
        }

        .post-insights.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .post-insights-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .post-insights-title {
            font-weight: 700;
            color: var(--black);
            font-size: 1rem;
        }

        .post-insights-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .post-insight-stat {
            text-align: center;
            padding: 0.75rem;
            background: white;
            border-radius: 10px;
        }

        .post-insight-stat-value {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--gold-dark);
            margin-bottom: 0.25rem;
            transition: all 0.3s ease;
        }

        .post-insight-stat-label {
            font-size: 0.75rem;
            color: var(--dark-gray);
        }

        /* COMMENTS SECTION */
        .comments-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--light-gray);
            display: none;
        }

        .comments-section.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        .comments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .comments-title {
            font-size: 1.1rem;
            color: var(--black);
            font-weight: 700;
        }

        .close-comments {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 6px;
            transition: all 0.3s ease;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-comments:hover {
            color: var(--gold-dark);
            transform: rotate(90deg);
            background: var(--gray);
        }

        .comments-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding-right: 5px;
            -webkit-overflow-scrolling: touch;
        }

        .comment-item {
            background: var(--comment-bg);
            padding: 1rem;
            border-radius: 14px;
            margin-bottom: 12px;
            animation: commentAppear 0.3s ease-out;
            border: 1px solid transparent;
            position: relative;
        }

        .comment-item:hover {
            border-color: var(--light-gray);
        }

        @keyframes commentAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .comment-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .comment-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
            border: 2px solid var(--gold-light);
        }

        .comment-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .comment-author {
            font-weight: 700;
            font-size: 0.9rem;
            color: var(--black);
            flex: 1;
            min-width: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .comment-time {
            font-size: 0.75rem;
            color: var(--dark-gray);
            flex-shrink: 0;
        }

        .comment-text {
            font-size: 0.9rem;
            line-height: 1.4;
            color: var(--black);
            margin-bottom: 8px;
        }

        .comment-actions {
            display: flex;
            gap: 16px;
            margin-top: 8px;
        }

        .comment-action {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.3s;
            font-weight: 500;
            padding: 4px 6px;
            border-radius: 8px;
        }

        .comment-action:hover {
            color: var(--gold-dark);
            background: var(--gray);
        }

        .comment-action.liked {
            color: #e74c3c;
            font-weight: 600;
        }

        .comment-action span {
            transition: all 0.3s ease;
        }

        /* REPLY SECTION */
        .replies-section {
            margin-top: 12px;
            margin-left: 42px;
            border-left: 2px solid var(--light-gray);
            padding-left: 16px;
        }

        .reply-item {
            background: var(--reply-bg);
            padding: 0.75rem;
            border-radius: 10px;
            margin-bottom: 10px;
            animation: commentAppear 0.3s ease-out;
        }

        .reply-form {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            margin-left: 42px;
            align-items: center;
            display: none;
        }

        .reply-input {
            flex: 1;
            padding: 10px 16px;
            border: 1.5px solid var(--light-gray);
            border-radius: 20px;
            font-size: 0.85rem;
            outline: none;
            background: var(--reply-bg);
            transition: all 0.3s ease;
            min-height: 40px;
        }

        .reply-input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.1);
            background: white;
        }

        .reply-submit {
            background: var(--gold);
            color: var(--black);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .reply-submit:hover {
            background: var(--gold-dark);
            transform: scale(1.1);
        }

        .comment-form {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .comment-input {
            flex: 1;
            padding: 12px 16px;
            border: 1.5px solid var(--light-gray);
            border-radius: 20px;
            outline: none;
            font-size: 0.9rem;
            background: var(--comment-bg);
            transition: all 0.3s ease;
            min-height: 44px;
        }

        .comment-input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.1);
            background: white;
        }

        .comment-submit {
            background: var(--gold);
            color: var(--black);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .comment-submit:hover {
            background: var(--gold-dark);
            transform: scale(1.1);
        }

        /* MODALS */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-overlay);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--white);
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
            padding: 1.5rem;
            text-align: center;
            position: relative;
            flex-shrink: 0;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: -0.3px;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.15);
            border: none;
            color: var(--black);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.4rem;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .close-modal:hover {
            background: rgba(0, 0, 0, 0.25);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 1.5rem;
            flex: 1;
            overflow-y: auto;
        }

        /* SIGNIN MODAL SPECIFIC */
        .onboarding-steps {
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
            gap: 6px;
        }

        .step-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--light-gray);
            transition: all 0.3s ease;
        }

        .step-indicator.active {
            width: 20px;
            border-radius: 3px;
            background: var(--gold);
        }

        .onboarding-slide {
            display: none;
            animation: slideIn 0.3s ease;
        }

        .onboarding-slide.active {
            display: block;
        }

        .club-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .club-card {
            background: white;
            border: 1.5px solid var(--light-gray);
            border-radius: 14px;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            min-height: 140px;
            position: relative;
            overflow: hidden;
        }

        .club-card:hover {
            transform: translateY(-2px);
            border-color: var(--gold);
            box-shadow: var(--hover-shadow);
        }

        .club-card.selected {
            border-color: var(--gold);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.05), rgba(212, 175, 55, 0.1));
        }

        .club-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            background: linear-gradient(135deg, var(--gold-light), var(--gold));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: var(--black);
            transition: all 0.3s ease;
        }

        .club-card:hover .club-icon {
            transform: scale(1.05);
        }

        .club-info h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
            color: var(--black);
            font-weight: 700;
        }

        .club-info p {
            font-size: 0.8rem;
            color: var(--dark-gray);
            margin: 0;
            line-height: 1.3;
        }

        .benefits-list {
            text-align: left;
            margin: 1.5rem 0;
            background: var(--gray);
            padding: 1.25rem;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        .benefits-list h4 {
            margin-bottom: 0.75rem;
            color: var(--gold-dark);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .benefits-list ul {
            list-style: none;
        }

        .benefits-list li {
            margin-bottom: 0.5rem;
            padding-left: 1.25rem;
            position: relative;
            color: var(--dark-gray);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .benefits-list li:before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: var(--gold);
            font-weight: bold;
        }

        .onboarding-footer {
            margin-top: 1.5rem;
            padding-top: 1.25rem;
            border-top: 1px solid var(--light-gray);
            text-align: center;
        }

        /* BUTTONS */
        .btn-primary {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            min-width: 160px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(212, 175, 55, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: var(--dark-gray);
            border: 1.5px solid var(--light-gray);
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .btn-outline:hover {
            border-color: var(--gold);
            color: var(--gold-dark);
        }

        /* CREATE POST FORM */
        .post-form-group {
            margin-bottom: 1.25rem;
        }

        .post-form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--black);
            font-size: 0.9rem;
        }

        .post-form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid var(--light-gray);
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: var(--white);
            color: var(--black);
        }

        .post-form-input:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .post-form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.5;
        }

        .post-form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
            cursor: pointer;
        }

        .post-form-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 0.5rem;
        }

        .tag-item {
            background: var(--gold-light);
            color: var(--gold-dark);
            padding: 4px 10px;
            border-radius: 14px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .tag-remove {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            padding: 0;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .tag-remove:hover {
            opacity: 1;
        }

        .post-form-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 2rem;
            padding-top: 1.25rem;
            border-top: 1px solid var(--light-gray);
        }

        .post-form-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: none;
        }

        .post-form-btn.primary {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
        }

        .post-form-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(212, 175, 55, 0.3);
        }

        .post-form-btn.secondary {
            background: var(--light-gray);
            color: var(--dark-gray);
        }

        .post-form-btn.secondary:hover {
            background: var(--dark-gray);
            color: white;
        }

        /* IMAGE UPLOAD */
        .image-upload-container {
            margin: 1rem 0;
        }

        .image-upload-preview {
            display: none;
            margin-top: 1rem;
            position: relative;
        }

        .image-upload-preview img {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 12px;
        }

        .remove-image-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .remove-image-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.1);
        }

        .upload-progress {
            margin-top: 0.5rem;
            display: none;
        }

        .upload-progress-bar {
            width: 100%;
            height: 6px;
            background: var(--light-gray);
            border-radius: 3px;
            overflow: hidden;
        }

        .upload-progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            width: 0%;
            transition: width 0.3s ease;
        }

        .upload-progress-text {
            font-size: 0.75rem;
            color: var(--dark-gray);
            margin-top: 4px;
            text-align: center;
        }

        .file-size-warning {
            font-size: 0.75rem;
            color: var(--dark-gray);
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .file-size-warning.error {
            color: var(--error);
        }

        .file-size-warning.success {
            color: var(--success);
        }

        /* DELETE CONFIRM MODAL */
        .delete-confirm-footer {
            display: flex;
            gap: 0.75rem;
            padding: 1.5rem;
            background: var(--white);
            border-top: 1px solid var(--light-gray);
            flex-shrink: 0;
        }

        .delete-cancel-btn, .delete-confirm-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            border: none;
        }

        .delete-cancel-btn {
            background: var(--light-gray);
            color: var(--dark-gray);
        }

        .delete-cancel-btn:hover {
            background: var(--dark-gray);
            color: white;
        }

        .delete-confirm-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .delete-confirm-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(231, 76, 60, 0.3);
        }

        /* NOTIFICATIONS LIST */
        .notifications-list {
            padding: 0;
        }

        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .notification-item:hover {
            background: var(--gray);
        }

        .notification-item.unread {
            background: rgba(212, 175, 55, 0.05);
        }

        .notification-item.unread:hover {
            background: rgba(212, 175, 55, 0.1);
        }

        .notification-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
            border: 2px solid var(--gold-light);
        }

        .notification-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-text {
            font-size: 0.9rem;
            color: var(--dark-gray);
            margin-bottom: 4px;
            line-height: 1.4;
        }

        .notification-time {
            font-size: 0.75rem;
            color: #999;
        }

        .notification-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--gold);
            border-radius: 50%;
            margin-right: 6px;
            vertical-align: middle;
            flex-shrink: 0;
        }

        .no-notifications {
            padding: 3rem 2rem;
            text-align: center;
            color: var(--dark-gray);
        }

        .no-notifications i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--light-gray);
        }

        /* LOADING AND EMPTY STATES */
        .loading {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gold-dark);
        }

        .loading-spinner {
            border: 3px solid var(--gold-light);
            border-top: 3px solid var(--gold);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--dark-gray);
        }

        .empty-state i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--gold-light);
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--black);
            font-weight: 700;
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 10px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* NOTIFICATION TOAST */
        .notification-toast {
            position: fixed;
            top: 80px;
            right: 10px;
            background: var(--black);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            z-index: 9999;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            max-width: calc(100vw - 40px);
            box-shadow: 0 5px 20px var(--shadow);
            font-weight: 500;
            backdrop-filter: blur(10px);
            font-size: 0.85rem;
        }

        .notification-toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification-toast.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .notification-toast.success {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--black);
        }

        .notification-toast.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        /* UTILITY CLASSES */
        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        
        .hidden {
            display: none !important;
        }

        /* GOOGLE SIGNIN */
        .google-signin-container {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }

        /* RESPONSIVE */
        @media (min-width: 768px) {
            .container {
                max-width: 600px;
                padding: 1rem 1.5rem;
            }
            
            .post-card {
                padding: 1.5rem;
                margin-bottom: 1.25rem;
            }
            
            .modal-content {
                border-radius: 20px;
            }
            
            .modal-header {
                border-radius: 20px 20px 0 0;
            }
            
            .post-avatar {
                width: 48px;
                height: 48px;
            }
            
            .post-author-info {
                max-width: calc(100% - 60px);
            }
            
            .follower-count {
                min-width: 50px;
            }
            
            .follow-btn {
                min-width: 70px;
            }
            
            .follow-btn.following {
                min-width: 80px;
            }
        }

        @media (max-width: 360px) {
            .club-selection {
                grid-template-columns: 1fr;
            }
            
            .post-actions {
                flex-wrap: wrap;
            }
            
            .post-action {
                min-width: 70px;
                padding: 6px 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Session Status Indicator -->
    <div class="session-status" id="sessionStatus">
        <i class="fas fa-check-circle"></i>
        <span>Session restored</span>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Create Post Button -->
    <button class="create-post-btn" id="createPostBtn">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Notification Toast -->
    <div class="notification-toast" id="notificationToast"></div>

    <!-- Notifications Modal -->
    <div class="modal" id="notificationsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Notifications</h2>
                <button class="close-modal" id="closeNotificationsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="notifications-list" id="notificationsList">
                    <div class="no-notifications">
                        <i class="fas fa-bell-slash"></i>
                        <p>No notifications yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign In Modal -->
    <div class="modal" id="signinModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Join the Inner Circle</h2>
                <p>UNBOUND | UNBENT | UNBROKEN</p>
                <button class="close-modal" id="closeSigninModal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Step 1: Welcome -->
                <div class="onboarding-slide active" id="step1">
                    <h3 style="margin-bottom: 1rem; color: var(--black);">Welcome to THE SONGA Inner Circle</h3>
                    <p>Experience exclusive access to our members-only platform where ambition meets opportunity.</p>
                    
                    <div class="benefits-list">
                        <h4>Inner Circle Benefits:</h4>
                        <ul>
                            <li>ðŸ“… Priority event updates and early bird access</li>
                            <li>ðŸ“š Curated subscription-based learning programs</li>
                            <li>ðŸŒŸ Talent development and business mentoring</li>
                            <li>ðŸ¤ Exclusive networking with investors & entrepreneurs</li>
                            <li>ðŸ’¼ Professional development workshops</li>
                            <li>ðŸŽ¯ Members-only resources and tools</li>
                        </ul>
                    </div>
                    
                    <p style="font-size: 0.9rem; color: var(--gold-dark); font-weight: 600;">
                        <i class="fas fa-crown"></i> Most services are subscription-based for committed members
                    </p>
                    
                    <div class="onboarding-footer">
                        <button class="btn-primary" id="startOnboardingBtn">
                            Get Started <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 2: Club Selection -->
                <div class="onboarding-slide" id="step2">
                    <h3 style="margin-bottom: 1rem; color: var(--black);">Choose Your Clubs</h3>
                    <p>Select the clubs that match your interests and goals:</p>
                    
                    <div class="club-selection">
                        <div class="club-card" data-club="logos">
                            <div class="club-icon">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="club-info">
                                <h4>Logos</h4>
                                <p>Reading & Literature Club</p>
                            </div>
                        </div>
                        
                        <div class="club-card" data-club="workfit">
                            <div class="club-icon">
                                <i class="fas fa-dumbbell"></i>
                            </div>
                            <div class="club-info">
                                <h4>WorkFit</h4>
                                <p>Fitness & Wellness Club</p>
                            </div>
                        </div>
                        
                        <div class="club-card" data-club="talantae">
                            <div class="club-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="club-info">
                                <h4>Talantae</h4>
                                <p>Talent Development Club</p>
                            </div>
                        </div>
                        
                        <div class="club-card" data-club="stratum">
                            <div class="club-icon">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <div class="club-info">
                                <h4>Stratum</h4>
                                <p>Professional & Business Club</p>
                            </div>
                        </div>
                    </div>
                    
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--dark-gray);">
                        <i class="fas fa-info-circle"></i> You can join multiple clubs and update preferences anytime
                    </p>
                    
                    <div class="onboarding-footer" style="display: flex; gap: 0.75rem; justify-content: center;">
                        <button class="btn-outline" id="backToStep1Btn">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="btn-primary" id="continueToStep3Btn" disabled>
                            Continue <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Step 3: Google Sign-in -->
                <div class="onboarding-slide" id="step3">
                    <h3 style="margin-bottom: 1rem; color: var(--black);">Complete Your Membership</h3>
                    <p>Sign in with Google to complete your Inner Circle registration and access exclusive benefits.</p>
                    
                    <div id="selectedClubs" style="margin: 1.5rem 0; padding: 1.25rem; background: var(--gray); border-radius: 12px;">
                        <h4 style="margin-bottom: 0.75rem; color: var(--gold-dark); font-size: 1.1rem;">Your Selected Clubs:</h4>
                        <div id="selectedClubsList" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>
                    </div>
                    
                    <div class="google-signin-container">
                        <div id="g_id_onload"
                             data-client_id="123922889572-9dmjivsoese0b0o78poo5mgu7nqqm6e6.apps.googleusercontent.com"
                             data-context="signin"
                             data-ux_mode="popup"
                             data-callback="handleGoogleSignIn"
                             data-auto_prompt="false">
                        </div>
                        <div class="g_id_signin"
                             data-type="standard"
                             data-shape="rectangular"
                             data-theme="outline"
                             data-text="signin_with"
                             data-size="large"
                             data-logo_alignment="left">
                        </div>
                    </div>
                    
                    <div class="onboarding-footer" style="display: flex; gap: 0.75rem; justify-content: center;">
                        <button class="btn-outline" id="backToStep2Btn">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                    </div>
                </div>
                
                <!-- Progress Indicators -->
                <div class="onboarding-steps">
                    <div class="step-indicator active" data-step="1"></div>
                    <div class="step-indicator" data-step="2"></div>
                    <div class="step-indicator" data-step="3"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Post Modal -->
    <div class="modal" id="createPostModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create New Post</h2>
                <button class="close-modal" id="closeCreatePostModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createPostForm">
                    <div class="post-form-group">
                        <label for="postTitle">Title *</label>
                        <input type="text" id="postTitle" class="post-form-input" placeholder="Enter post title" required>
                    </div>
                    
                    <div class="post-form-group">
                        <label for="postContent">Content *</label>
                        <textarea id="postContent" class="post-form-input post-form-textarea" placeholder="Share your thoughts..." required></textarea>
                    </div>
                    
                    <div class="post-form-group">
                        <label for="postImage">Add Image (optional, max 10MB)</label>
                        <input type="file" id="postImage" class="post-form-input" accept="image/*" style="padding: 8px 16px;">
                        <div class="file-size-warning" id="fileSizeWarning">
                            <i class="fas fa-info-circle"></i>
                            <span>Maximum file size: 10MB</span>
                        </div>
                        
                        <div class="image-upload-container">
                            <div class="image-upload-preview" id="imagePreview">
                                <img id="previewImage" src="" alt="Preview">
                                <button type="button" class="remove-image-btn" id="removeImageBtn">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="upload-progress" id="uploadProgress">
                                <div class="upload-progress-bar">
                                    <div class="upload-progress-fill" id="uploadProgressFill"></div>
                                </div>
                                <div class="upload-progress-text" id="uploadProgressText">Uploading...</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="post-form-group">
                        <label for="postCategory">Category</label>
                        <select id="postCategory" class="post-form-input post-form-select">
                            <option value="announcement">Announcement</option>
                            <option value="event">Event</option>
                            <option value="resource">Resource</option>
                            <option value="discussion">Discussion</option>
                        </select>
                    </div>
                    
                    <div class="post-form-group">
                        <label for="postTags">Tags</label>
                        <input type="text" id="postTags" class="post-form-input" placeholder="Add tags (separated by commas)">
                        <div class="post-form-tags" id="postTagsContainer"></div>
                    </div>
                    
                    <div class="post-form-group">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="postIsPinned">
                            Pin this post to the top
                        </label>
                    </div>
                    
                    <div class="post-form-actions">
                        <button type="button" class="post-form-btn secondary" id="cancelCreatePostBtn">
                            Cancel
                        </button>
                        <button type="submit" class="post-form-btn primary" id="submitPostBtn">
                            <i class="fas fa-paper-plane"></i> Publish Post
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Delete Post</h2>
                <p>Are you sure you want to delete this post?</p>
            </div>
            <div class="modal-body">
                <p>This action cannot be undone. The post and all its comments will be permanently deleted.</p>
            </div>
            <div class="delete-confirm-footer">
                <button class="delete-cancel-btn" id="cancelDeleteBtn">Cancel</button>
                <button class="delete-confirm-btn" id="confirmDeleteBtn">Delete Post</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo" id="logo">
                <img src="https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp" alt="THE SONGA Logo">
                <div class="brand-info">
                    <div class="brand-name">THE SONGA</div>
                    <div class="brand-subtitle">UNBOUND | UNBENT | UNBROKEN</div>
                </div>
            </div>
            
            <div class="auth-section">
                <div class="notification-btn" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <div class="notification-badge hidden" id="notificationBadge"></div>
                </div>
                
                <div id="userProfile" class="user-profile">
                    <div class="user-avatar">
                        <img id="userAvatar" src="" alt="User Avatar">
                    </div>
                    <div class="user-name" id="userDisplayName"></div>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="dropdown-item" id="myClubsOption">
                            <i class="fas fa-users"></i>
                            <span>My Clubs</span>
                        </div>
                        <div class="dropdown-item" id="myProfileOption">
                            <i class="fas fa-user-circle"></i>
                            <span>My Profile</span>
                        </div>
                        <div class="dropdown-item" id="signOutOption">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Sign Out</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <div class="community-posts">
            <div class="posts-header">
                <h1 class="posts-title">
                    Community Feed
                    <span class="inner-circle-badge">Inner Circle</span>
                    <span class="new-posts-indicator" id="newPostsIndicator">New Posts Available</span>
                </h1>
                <p>
                    Exclusive updates and announcements from THE SONGA Inner Circle.
                </p>
                
                <!-- Categories Filter -->
                <div class="categories-filter">
                    <button class="category-filter-btn active" data-category="all" id="filterAllBtn">
                        All Posts
                    </button>
                    <button class="category-filter-btn" data-category="announcement" id="filterAnnouncementBtn">
                        <i class="fas fa-bullhorn"></i> Announcements
                    </button>
                    <button class="category-filter-btn" data-category="event" id="filterEventBtn">
                        <i class="fas fa-calendar-alt"></i> Events
                    </button>
                    <button class="category-filter-btn" data-category="resource" id="filterResourceBtn">
                        <i class="fas fa-book"></i> Resources
                    </button>
                    <button class="category-filter-btn" data-category="discussion" id="filterDiscussionBtn">
                        <i class="fas fa-comments"></i> Discussions
                    </button>
                </div>
            </div>

            <!-- Posts Container -->
            <div id="postsContainer">
                <!-- Posts will be loaded here -->
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav" id="bottomNav">
        <a href="#" class="nav-item active" id="navFeed">
            <i class="fas fa-home nav-icon"></i>
            <span>Feed</span>
        </a>
        <a href="events.html" class="nav-item">
            <i class="fas fa-calendar-alt nav-icon"></i>
            <span>Events</span>
        </a>
        <a href="library.html" class="nav-item">
            <i class="fas fa-book nav-icon"></i>
            <span>Library</span>
        </a>
        <a href="profile.html" class="nav-item">
            <i class="fas fa-user nav-icon"></i>
            <span>Profile</span>
        </a>
    </nav>

    <!-- Firebase and Google Sign-In SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

            <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBDZicoo7dFLtSmgRPvQE_gdm-tNOyCTXA",
            authDomain: "the-songa-77b1b.firebaseapp.com",
            databaseURL: "https://the-songa-77b1b-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "the-songa-77b1b",
            storageBucket: "the-songa-77b1b.firebasestorage.app",
            messagingSenderId: "123922889572",
            appId: "1:123922889572:web:482b2a624930baaf92d871"
        };

        // Initialize Firebase with error handling for multiple initializations
        let firebaseApp;
        let database;
        let auth;
        let storage;
        
        try {
            // Check if Firebase is already initialized
            if (!firebase.apps.length) {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                console.log("Firebase initialized successfully");
            } else {
                firebaseApp = firebase.app(); // Use existing app
                console.log("Firebase already initialized, using existing instance");
            }
            
            database = firebase.database();
            auth = firebase.auth();
            storage = firebase.storage();
        } catch (error) {
            console.error("Firebase initialization error:", error);
            // Try to get existing app
            try {
                firebaseApp = firebase.app();
                database = firebase.database();
                auth = firebase.auth();
                storage = firebase.storage();
            } catch (e) {
                console.error("Could not initialize Firebase:", e);
            }
        }

        // Global variables
        let currentUser = null;
        let currentUserData = null;
        let posts = [];
        let selectedClubs = [];
        let currentStep = 1;
        let currentFilter = 'all';
        let postToDelete = null;
        let realtimeListeners = [];
        let currentImageFile = null;

        // DOM Elements
        const elements = {
            // Session
            sessionStatus: document.getElementById('sessionStatus'),
            
            // Buttons
            backToTop: document.getElementById('backToTop'),
            createPostBtn: document.getElementById('createPostBtn'),
            notificationBtn: document.getElementById('notificationBtn'),
            
            // Modals
            notificationsModal: document.getElementById('notificationsModal'),
            signinModal: document.getElementById('signinModal'),
            createPostModal: document.getElementById('createPostModal'),
            deleteConfirmModal: document.getElementById('deleteConfirmModal'),
            
            // Modal close buttons
            closeNotificationsModal: document.getElementById('closeNotificationsModal'),
            closeSigninModal: document.getElementById('closeSigninModal'),
            closeCreatePostModal: document.getElementById('closeCreatePostModal'),
            cancelCreatePostBtn: document.getElementById('cancelCreatePostBtn'),
            cancelDeleteBtn: document.getElementById('cancelDeleteBtn'),
            confirmDeleteBtn: document.getElementById('confirmDeleteBtn'),
            
            // User profile
            userProfile: document.getElementById('userProfile'),
            userAvatar: document.getElementById('userAvatar'),
            userDisplayName: document.getElementById('userDisplayName'),
            userDropdown: document.getElementById('userDropdown'),
            
            // Notification
            notificationToast: document.getElementById('notificationToast'),
            notificationBadge: document.getElementById('notificationBadge'),
            notificationsList: document.getElementById('notificationsList'),
            
            // Posts
            postsContainer: document.getElementById('postsContainer'),
            newPostsIndicator: document.getElementById('newPostsIndicator'),
            
            // Filter buttons
            filterAllBtn: document.getElementById('filterAllBtn'),
            filterAnnouncementBtn: document.getElementById('filterAnnouncementBtn'),
            filterEventBtn: document.getElementById('filterEventBtn'),
            filterResourceBtn: document.getElementById('filterResourceBtn'),
            filterDiscussionBtn: document.getElementById('filterDiscussionBtn'),
            
            // Onboarding
            startOnboardingBtn: document.getElementById('startOnboardingBtn'),
            backToStep1Btn: document.getElementById('backToStep1Btn'),
            continueToStep3Btn: document.getElementById('continueToStep3Btn'),
            backToStep2Btn: document.getElementById('backToStep2Btn'),
            selectedClubsList: document.getElementById('selectedClubsList'),
            
            // Forms
            createPostForm: document.getElementById('createPostForm'),
            postTags: document.getElementById('postTags'),
            postTagsContainer: document.getElementById('postTagsContainer'),
            postImage: document.getElementById('postImage'),
            imagePreview: document.getElementById('imagePreview'),
            previewImage: document.getElementById('previewImage'),
            removeImageBtn: document.getElementById('removeImageBtn'),
            fileSizeWarning: document.getElementById('fileSizeWarning'),
            uploadProgress: document.getElementById('uploadProgress'),
            uploadProgressFill: document.getElementById('uploadProgressFill'),
            uploadProgressText: document.getElementById('uploadProgressText'),
            submitPostBtn: document.getElementById('submitPostBtn'),
            
            // Navigation
            signOutOption: document.getElementById('signOutOption'),
            logo: document.getElementById('logo'),
            bottomNav: document.getElementById('bottomNav'),
            navFeed: document.getElementById('navFeed')
        };

        // Club data
        const clubs = {
            logos: {
                name: 'Logos',
                description: 'Reading & Literature Club',
                icon: 'fas fa-book-open',
                color: '#3498db'
            },
            workfit: {
                name: 'WorkFit',
                description: 'Fitness & Wellness Club',
                icon: 'fas fa-dumbbell',
                color: '#2ecc71'
            },
            talantae: {
                name: 'Talantae',
                description: 'Talent Development Club',
                icon: 'fas fa-star',
                color: '#9b59b6'
            },
            stratum: {
                name: 'Stratum',
                description: 'Professional & Business Club',
                icon: 'fas fa-briefcase',
                color: '#e74c3c'
            }
        };

        // Show notification toast
        function showNotification(message, type = 'success', duration = 4000) {
            const toast = elements.notificationToast;
            if (!toast) return;
            
            toast.textContent = message;
            toast.className = `notification-toast show ${type}`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Show session status
        function showSessionStatus(message, type = 'restored') {
            const status = elements.sessionStatus;
            if (!status) return;
            
            status.innerHTML = `
                <i class="fas fa-${type === 'restored' ? 'check-circle' : 'sync'}"></i>
                <span>${message}</span>
            `;
            status.className = `session-status visible ${type}`;
            
            setTimeout(() => {
                status.classList.remove('visible');
            }, 3000);
        }

        // Format time
        function formatTime(timestamp) {
            if (!timestamp) return 'Recently';
            const now = new Date();
            const postTime = new Date(timestamp);
            const diffInSeconds = Math.floor((now - postTime) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
            if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)}d ago`;
            
            return postTime.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                year: postTime.getFullYear() !== now.getFullYear() ? 'numeric' : undefined
            });
        }

        // Check authentication status
        function checkAuthStatus() {
            const storedUser = localStorage.getItem('the_songa_user');
            const storedToken = localStorage.getItem('the_songa_token');
            const sessionTime = localStorage.getItem('the_songa_session_time');
            
            // Check if session is still valid (24 hours)
            const isSessionValid = sessionTime && (Date.now() - parseInt(sessionTime)) < (24 * 60 * 60 * 1000);
            
            if (storedUser && storedToken && isSessionValid) {
                try {
                    currentUser = JSON.parse(storedUser);
                    showSessionStatus('Session restored', 'restored');
                    
                    // Update UI
                    updateUIForMember();
                    
                    // Hide signin modal if open
                    if (elements.signinModal) {
                        elements.signinModal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                    }
                    
                    // Fetch user data
                    fetchUserData(currentUser.uid);
                    
                    // Setup realtime listeners
                    setupRealtimeListeners();
                    
                    // Only show welcome back if on homepage
                    if (window.location.pathname.includes('index.html') || 
                        window.location.pathname === '/' || 
                        window.location.pathname.includes('feed')) {
                        showNotification(`Welcome back, ${currentUser.firstName}!`, 'success');
                    }
                    
                    return true;
                } catch (error) {
                    console.error("Error parsing stored user:", error);
                    clearUserSession();
                    if (elements.signinModal) {
                        showSigninModal();
                    }
                    return false;
                }
            } else {
                clearUserSession();
                if (elements.signinModal) {
                    showSigninModal();
                }
                return false;
            }
        }

        // Setup realtime listeners
        function setupRealtimeListeners() {
            // Clear existing listeners
            realtimeListeners.forEach(listener => {
                if (typeof listener === 'function') {
                    listener();
                }
            });
            realtimeListeners = [];

            if (!currentUser || !database) return;

            // Listen for notifications (works on all pages)
            const notificationsListener = database.ref(`notifications/${currentUser.uid}`).orderByChild('timestamp').limitToLast(50).on('value', (snapshot) => {
                if (snapshot.exists()) {
                    const notifications = snapshot.val();
                    const unreadCount = Object.values(notifications).filter(n => !n.read).length;
                    
                    // Update badge if element exists
                    if (elements.notificationBadge) {
                        if (unreadCount > 0) {
                            elements.notificationBadge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                            elements.notificationBadge.classList.remove('hidden');
                        } else {
                            elements.notificationBadge.classList.add('hidden');
                        }
                    }
                    
                    // Update notifications modal if open
                    if (elements.notificationsModal && elements.notificationsModal.classList.contains('active')) {
                        loadNotifications();
                    }
                } else if (elements.notificationBadge) {
                    elements.notificationBadge.classList.add('hidden');
                }
            });
            realtimeListeners.push(() => database.ref(`notifications/${currentUser.uid}`).off('value', notificationsListener));

            // Only setup post listeners on feed page
            if (window.location.pathname.includes('index.html') || 
                window.location.pathname === '/' || 
                window.location.pathname.includes('feed') ||
                document.getElementById('postsContainer')) {
                
                // Listen for new posts
                const postsListener = database.ref('communityPosts').orderByChild('createdAt').limitToLast(50).on('value', (snapshot) => {
                    if (snapshot.exists()) {
                        const postsData = snapshot.val();
                        posts = Object.keys(postsData).map(key => ({
                            id: key,
                            ...postsData[key]
                        })).filter(post => post.status === 'published');
                        
                        // Update posts display if on feed page
                        if (elements.postsContainer) {
                            filterPosts(currentFilter);
                            checkNewPosts();
                        }
                    }
                });
                realtimeListeners.push(() => database.ref('communityPosts').off('value', postsListener));
            }

            // Listen for user data updates
            const userListener = database.ref(`users/${currentUser.uid}`).on('value', (snapshot) => {
                if (snapshot.exists()) {
                    currentUserData = snapshot.val();
                }
            });
            realtimeListeners.push(() => database.ref(`users/${currentUser.uid}`).off('value', userListener));
        }

        // Check for new posts (feed page only)
        function checkNewPosts() {
            if (!elements.newPostsIndicator) return;
            
            const lastViewed = localStorage.getItem('the_songa_last_viewed') || Date.now();
            const newPostsCount = posts.filter(post => 
                new Date(post.createdAt) > new Date(parseInt(lastViewed))
            ).length;
            
            if (newPostsCount > 0) {
                elements.newPostsIndicator.textContent = `${newPostsCount} New Posts`;
                elements.newPostsIndicator.style.display = 'inline-flex';
            } else {
                elements.newPostsIndicator.style.display = 'none';
            }
        }

        // Mark posts as viewed (feed page only)
        function markPostsAsViewed() {
            if (!elements.newPostsIndicator) return;
            
            localStorage.setItem('the_songa_last_viewed', Date.now().toString());
            elements.newPostsIndicator.style.display = 'none';
        }

        // Store user session
        function storeUserSession(user, token) {
            localStorage.setItem('the_songa_user', JSON.stringify(user));
            localStorage.setItem('the_songa_token', token);
            localStorage.setItem('the_songa_session_time', Date.now().toString());
            localStorage.setItem('the_songa_selected_clubs', JSON.stringify(selectedClubs));
        }

        // Clear user session
        function clearUserSession() {
            localStorage.removeItem('the_songa_user');
            localStorage.removeItem('the_songa_token');
            localStorage.removeItem('the_songa_session_time');
            localStorage.removeItem('the_songa_selected_clubs');
            
            // Remove realtime listeners
            realtimeListeners.forEach(listener => {
                if (typeof listener === 'function') {
                    listener();
                }
            });
            realtimeListeners = [];
        }

        // Show signin modal
        function showSigninModal() {
            if (!elements.signinModal) return;
            
            elements.signinModal.classList.add('active');
            document.body.classList.add('modal-open');
            
            // Try to restore selected clubs
            const storedClubs = localStorage.getItem('the_songa_selected_clubs');
            if (storedClubs) {
                try {
                    selectedClubs = JSON.parse(storedClubs);
                    selectedClubs.forEach(clubId => {
                        const clubCard = document.querySelector(`.club-card[data-club="${clubId}"]`);
                        if (clubCard) {
                            clubCard.classList.add('selected');
                        }
                    });
                    updateContinueButton();
                } catch (error) {
                    console.error("Error parsing stored clubs:", error);
                }
            }
        }

        // Update UI for member
        function updateUIForMember() {
            if (currentUser) {
                // Show user profile if element exists
                if (elements.userProfile) {
                    elements.userProfile.style.display = 'flex';
                    if (elements.userAvatar) elements.userAvatar.src = currentUser.picture;
                    if (elements.userDisplayName) elements.userDisplayName.textContent = currentUser.firstName;
                }
                
                // Show create post button if element exists
                if (elements.createPostBtn) {
                    elements.createPostBtn.style.display = 'flex';
                }
                
                // Show notification button if element exists
                if (elements.notificationBtn) {
                    elements.notificationBtn.style.display = 'flex';
                }
            }
        }

        // Fetch user data
        async function fetchUserData(userId) {
            try {
                const userRef = database.ref(`users/${userId}`);
                const snapshot = await userRef.once('value');
                if (snapshot.exists()) {
                    currentUserData = snapshot.val();
                    // Update selectedClubs from database
                    if (currentUserData.selectedClubs) {
                        selectedClubs = currentUserData.selectedClubs;
                    }
                }
            } catch (error) {
                console.error('Error fetching user data:', error);
            }
        }

        // Load notifications with proper error handling
        async function loadNotifications() {
            if (!currentUser || !database) {
                showNotification('Please sign in to view notifications', 'error');
                return;
            }
            
            try {
                const notificationsRef = database.ref(`notifications/${currentUser.uid}`).orderByChild('timestamp').limitToLast(50);
                const snapshot = await notificationsRef.once('value');
                
                const notificationsList = elements.notificationsList;
                if (!notificationsList) {
                    console.error('Notifications list element not found');
                    return;
                }
                
                if (snapshot.exists()) {
                    const notificationsData = snapshot.val();
                    const notifications = Object.keys(notificationsData).map(key => ({
                        id: key,
                        ...notificationsData[key]
                    })).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    // Clear and build notifications list
                    notificationsList.innerHTML = '';
                    
                    notifications.forEach(notification => {
                        const timeAgo = formatTime(notification.timestamp);
                        let notificationText = '';
                        let icon = 'fas fa-bell';
                        let avatarUrl = 'https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp';
                        
                        // Handle different notification types
                        switch(notification.type) {
                            case 'like':
                                notificationText = `<strong>${notification.data?.userName || 'Someone'}</strong> liked your post`;
                                if (notification.data?.userAvatar) avatarUrl = notification.data.userAvatar;
                                icon = 'fas fa-heart';
                                break;
                            case 'comment':
                                notificationText = `<strong>${notification.data?.userName || 'Someone'}</strong> commented on your post`;
                                if (notification.data?.userAvatar) avatarUrl = notification.data.userAvatar;
                                icon = 'fas fa-comment';
                                break;
                            case 'share':
                                notificationText = `<strong>${notification.data?.userName || 'Someone'}</strong> shared your post`;
                                if (notification.data?.userAvatar) avatarUrl = notification.data.userAvatar;
                                icon = 'fas fa-share';
                                break;
                            case 'follow':
                                notificationText = `<strong>${notification.data?.userName || 'Someone'}</strong> started following you`;
                                if (notification.data?.userAvatar) avatarUrl = notification.data.userAvatar;
                                icon = 'fas fa-user-plus';
                                break;
                            case 'post':
                                notificationText = `<strong>${notification.data?.userName || 'Someone'}</strong> created a new post`;
                                if (notification.data?.userAvatar) avatarUrl = notification.data.userAvatar;
                                icon = 'fas fa-newspaper';
                                break;
                            default:
                                notificationText = `New notification`;
                                icon = 'fas fa-bell';
                        }
                        
                        const notificationItem = document.createElement('div');
                        notificationItem.className = `notification-item ${notification.read ? '' : 'unread'}`;
                        notificationItem.innerHTML = `
                            <div class="notification-avatar">
                                <img src="${avatarUrl}" alt="User">
                            </div>
                            <div class="notification-content">
                                <div class="notification-text">
                                    <i class="${icon}"></i> ${notificationText}
                                </div>
                                <div class="notification-time">${timeAgo}</div>
                            </div>
                            ${notification.read ? '' : '<div class="notification-dot"></div>'}
                        `;
                        
                        // Add click handler
                        notificationItem.addEventListener('click', () => {
                            viewNotification(notification.id, notification.data?.postId);
                        });
                        
                        notificationsList.appendChild(notificationItem);
                    });
                } else {
                    notificationsList.innerHTML = `
                        <div class="no-notifications">
                            <i class="fas fa-bell-slash"></i>
                            <p>No notifications yet</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading notifications:', error);
                if (elements.notificationsList) {
                    elements.notificationsList.innerHTML = `
                        <div class="no-notifications">
                            <i class="fas fa-exclamation-circle"></i>
                            <p>Error loading notifications. Please try again.</p>
                        </div>
                    `;
                }
                showNotification('Error loading notifications', 'error');
            }
        }

        // View notification and mark as read
        async function viewNotification(notificationId, postId = null) {
            try {
                // Mark notification as read
                const notificationRef = database.ref(`notifications/${currentUser.uid}/${notificationId}`);
                await notificationRef.update({ read: true });
                
                // Close notifications modal
                if (elements.notificationsModal) {
                    elements.notificationsModal.classList.remove('active');
                    document.body.classList.remove('modal-open');
                }
                
                // Handle notification action based on type
                if (postId) {
                    // If it's a post-related notification, navigate to the post
                    const isOnFeedPage = window.location.pathname.includes('index.html') || 
                                        window.location.pathname === '/' || 
                                        window.location.pathname.includes('feed');
                    
                    if (isOnFeedPage) {
                        // Scroll to post on feed page
                        const postElement = document.getElementById(`post-${postId}`);
                        if (postElement) {
                            postElement.scrollIntoView({ behavior: 'smooth' });
                            postElement.classList.add('real-time-update');
                            setTimeout(() => {
                                postElement.classList.remove('real-time-update');
                            }, 2000);
                        }
                    } else {
                        // Redirect to feed page with post anchor
                        window.location.href = `index.html#post-${postId}`;
                    }
                }
            } catch (error) {
                console.error('Error viewing notification:', error);
                showNotification('Error processing notification', 'error');
            }
        }

        // Load posts (feed page only)
        async function loadPosts() {
            if (!elements.postsContainer) return;
            
            try {
                const postsRef = database.ref('communityPosts').orderByChild('createdAt').limitToLast(50);
                const snapshot = await postsRef.once('value');
                
                if (snapshot.exists()) {
                    const postsData = snapshot.val();
                    posts = Object.keys(postsData).map(key => ({
                        id: key,
                        ...postsData[key]
                    })).filter(post => post.status === 'published');
                    
                    filterPosts(currentFilter);
                    checkNewPosts();
                } else {
                    // Load sample posts if none exist
                    loadSamplePosts();
                    renderPosts([]);
                }
            } catch (error) {
                console.error('Error loading posts:', error);
                showNotification('Error loading posts', 'error');
                renderPosts([]);
            }
        }

        // Load sample posts
        async function loadSamplePosts() {
            if (!database || !elements.postsContainer) return;
            
            try {
                const postsRef = database.ref('communityPosts');
                const snapshot = await postsRef.once('value');
                
                if (!snapshot.exists()) {
                    const samplePosts = {
                        post1: {
                            id: "post1",
                            authorId: "admin1",
                            authorName: "THE SONGA",
                            authorAvatar: "https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp",
                            title: "Welcome to the Inner Circle!",
                            content: "We're thrilled to have you as part of THE SONGA Inner Circle. This is your exclusive space to connect, learn, and grow with like-minded individuals.\n\nWhat to expect:\nðŸ“š Exclusive content from your selected clubs\nðŸŽ¯ Practical strategies and workshops\nðŸ¤ Networking with ambitious members\nðŸ’¡ Priority updates and announcements\nðŸŒŸ Member success stories\n\nWelcome aboard!\n- The SONGA Team",
                            category: "announcement",
                            tags: ["welcome", "inner-circle", "community"],
                            likes: 24,
                            likedBy: [],
                            comments: 8,
                            shares: 3,
                            bookmarks: 15,
                            views: 156,
                            createdAt: new Date().toISOString(),
                            isPinned: true,
                            status: "published"
                        },
                        post2: {
                            id: "post2",
                            authorId: "admin1",
                            authorName: "THE SONGA",
                            authorAvatar: "https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp",
                            title: "Wealth Building Workshop - This Saturday!",
                            content: "Join us for an exclusive Inner Circle workshop where we'll dive deep into practical wealth creation strategies.\n\nWorkshop Highlights:\nâ€¢ Investment strategies for beginners\nâ€¢ Passive income opportunities\nâ€¢ Wealth preservation techniques\n\nDate: This Saturday, 2:00 PM\nLocation: Virtual - Members Portal\n\nExclusively for Inner Circle members!",
                            category: "event",
                            tags: ["workshop", "finance", "wealth", "inner-circle"],
                            likes: 18,
                            likedBy: [],
                            comments: 5,
                            shares: 2,
                            bookmarks: 8,
                            views: 89,
                            createdAt: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                            isPinned: false,
                            status: "published"
                        },
                        post3: {
                            id: "post3",
                            authorId: "admin2",
                            authorName: "Logos Club",
                            authorAvatar: "https://i.postimg.cc/BbdzCkxQ/20260116-0851-Elegant-Lion-Emblem-remix-01kf2npwbtf06ttr4htekjnd47-removebg-preview-2.webp",
                            title: "March Reading Challenge",
                            content: "Logos Club members, get ready for our March reading challenge! This month's theme: 'Financial Literacy'.\n\nFeatured Books:\nâ€¢ The Psychology of Money\nâ€¢ Rich Dad Poor Dad\nâ€¢ The Intelligent Investor\n\nJoin our weekly discussions every Thursday at 7 PM.",
                            category: "discussion",
                            tags: ["logos", "reading", "challenge", "books"],
                            likes: 12,
                            likedBy: [],
                            comments: 3,
                            shares: 1,
                            bookmarks: 5,
                            views: 45,
                            createdAt: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
                            isPinned: false,
                            status: "published"
                        }
                    };
                    
                    await postsRef.set(samplePosts);
                    console.log("Sample posts loaded");
                }
            } catch (error) {
                console.error('Error loading sample posts:', error);
            }
        }

        // Onboarding functions
        function nextStep(step) {
            // Validate step 2
            if (step === 3 && selectedClubs.length === 0) {
                showNotification('Please select at least one club to continue', 'error');
                return;
            }
            
            // Update step indicators
            document.querySelectorAll('.step-indicator').forEach(indicator => {
                indicator.classList.remove('active');
            });
            document.querySelector(`.step-indicator[data-step="${step}"]`)?.classList.add('active');
            
            // Hide current step
            document.querySelectorAll('.onboarding-slide').forEach(slide => {
                slide.classList.remove('active');
            });
            
            // Show next step
            const stepElement = document.getElementById(`step${step}`);
            if (stepElement) {
                stepElement.classList.add('active');
                currentStep = step;
                
                // Update selected clubs display for step 3
                if (step === 3) {
                    updateSelectedClubsDisplay();
                }
            }
        }

        function prevStep() {
            const prevStep = currentStep - 1;
            if (prevStep >= 1) {
                nextStep(prevStep);
            }
        }

        function toggleClubSelection(clubId) {
            const clubCard = document.querySelector(`.club-card[data-club="${clubId}"]`);
            const index = selectedClubs.indexOf(clubId);
            
            if (index === -1) {
                selectedClubs.push(clubId);
                clubCard?.classList.add('selected');
            } else {
                selectedClubs.splice(index, 1);
                clubCard?.classList.remove('selected');
            }
            
            updateContinueButton();
        }

        function updateContinueButton() {
            const continueBtn = elements.continueToStep3Btn;
            if (continueBtn) {
                continueBtn.disabled = selectedClubs.length === 0;
            }
        }

        function updateSelectedClubsDisplay() {
            const selectedClubsList = elements.selectedClubsList;
            if (!selectedClubsList) return;
            
            selectedClubsList.innerHTML = selectedClubs.map(clubId => {
                const club = clubs[clubId];
                return `
                    <div style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; background: white; border-radius: 16px; border: 1.5px solid ${club.color}20;">
                        <i class="${club.icon}" style="color: ${club.color}; font-size: 0.9rem;"></i>
                        <span style="font-weight: 600; font-size: 0.85rem;">${club.name}</span>
                    </div>
                `;
            }).join('');
        }

        // Google Sign-In Handler
        async function handleGoogleSignIn(response) {
            try {
                const credential = response.credential;
                const userData = parseJwt(credential);
                
                currentUser = {
                    uid: userData.sub,
                    email: userData.email,
                    firstName: userData.given_name,
                    lastName: userData.family_name,
                    fullName: userData.name,
                    picture: userData.picture,
                    emailVerified: userData.email_verified
                };
                
                // Store session
                storeUserSession(currentUser, credential);
                
                const userRef = database.ref(`users/${currentUser.uid}`);
                const snapshot = await userRef.once('value');
                
                if (!snapshot.exists()) {
                    // New user
                    const newUser = {
                        uid: currentUser.uid,
                        email: currentUser.email,
                        firstName: currentUser.firstName,
                        lastName: currentUser.lastName,
                        profilePicture: currentUser.picture,
                        joinedDate: new Date().toISOString(),
                        lastLogin: new Date().toISOString(),
                        membershipStatus: "active",
                        membershipTier: "inner-circle",
                        selectedClubs: selectedClubs,
                        bookmarkedPosts: [],
                        followers: [],
                        following: [],
                        isAdmin: false,
                        status: "active"
                    };
                    
                    await userRef.set(newUser);
                    currentUserData = newUser;
                    showNotification(`Welcome to THE SONGA Inner Circle, ${currentUser.firstName}!`, 'success');
                } else {
                    // Existing user
                    await userRef.update({ 
                        lastLogin: new Date().toISOString(),
                        selectedClubs: selectedClubs
                    });
                    currentUserData = snapshot.val();
                    showNotification(`Welcome back, ${currentUser.firstName}!`, 'success');
                }
                
                updateUIForMember();
                if (elements.signinModal) {
                    elements.signinModal.classList.remove('active');
                    document.body.classList.remove('modal-open');
                }
                
                // Setup realtime listeners
                setupRealtimeListeners();
                
                // Reset onboarding
                selectedClubs = [];
                currentStep = 1;
                document.querySelectorAll('.club-card').forEach(card => {
                    card.classList.remove('selected');
                });
                updateContinueButton();
                
            } catch (error) {
                console.error('Error in Google Sign-In:', error);
                showNotification('Error signing in. Please try again.', 'error');
            }
        }

        // Parse JWT token
        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => 
                    '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
                ).join(''));
                return JSON.parse(jsonPayload);
            } catch (error) {
                console.error('Error parsing JWT:', error);
                return {};
            }
        }

        // Sign out
        function signOut() {
            clearUserSession();
            currentUser = null;
            currentUserData = null;
            selectedClubs = [];
            
            // Close all modals
            document.querySelectorAll('.modal.active').forEach(modal => {
                modal.classList.remove('active');
            });
            document.body.classList.remove('modal-open');
            
            // Update UI
            if (elements.userProfile) elements.userProfile.style.display = 'none';
            if (elements.createPostBtn) elements.createPostBtn.style.display = 'none';
            if (elements.notificationBtn) elements.notificationBtn.style.display = 'none';
            
            // Reset onboarding
            currentStep = 1;
            document.querySelectorAll('.onboarding-slide').forEach((slide, index) => {
                slide.classList.toggle('active', index === 0);
            });
            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                indicator.classList.toggle('active', index === 0);
            });
            
            // Show signin modal
            if (elements.signinModal) {
                showSigninModal();
            }
            
            showNotification('Signed out successfully', 'success');
            showSessionStatus('Signed out', 'restored');
        }

        // Open create post modal
        function openCreatePostModal() {
            if (!currentUser) {
                showNotification('Please join the Inner Circle to create posts', 'error');
                return;
            }
            
            if (elements.createPostModal) {
                elements.createPostModal.classList.add('active');
                document.body.classList.add('modal-open');
            }
        }

        // Initialize event listeners
        function initEventListeners() {
            // Logo click
            if (elements.logo) {
                elements.logo.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            // Back to top
            if (elements.backToTop) {
                elements.backToTop.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            // Create post button
            if (elements.createPostBtn) {
                elements.createPostBtn.addEventListener('click', openCreatePostModal);
            }

            // Notification button
            if (elements.notificationBtn) {
                elements.notificationBtn.addEventListener('click', () => {
                    if (!currentUser) {
                        showNotification('Please join the Inner Circle to view notifications', 'error');
                        return;
                    }
                    if (elements.notificationsModal) {
                        elements.notificationsModal.classList.add('active');
                        document.body.classList.add('modal-open');
                        loadNotifications();
                    }
                });
            }

            // User profile dropdown
            if (elements.userProfile) {
                elements.userProfile.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (elements.userDropdown) {
                        elements.userDropdown.classList.toggle('active');
                    }
                });
            }

            // Close dropdowns when clicking outside
            document.addEventListener('click', () => {
                if (elements.userDropdown) {
                    elements.userDropdown.classList.remove('active');
                }
            });

            // Filter buttons (feed page only)
            if (elements.filterAllBtn) {
                elements.filterAllBtn.addEventListener('click', () => filterPosts('all'));
                elements.filterAnnouncementBtn.addEventListener('click', () => filterPosts('announcement'));
                elements.filterEventBtn.addEventListener('click', () => filterPosts('event'));
                elements.filterResourceBtn.addEventListener('click', () => filterPosts('resource'));
                elements.filterDiscussionBtn.addEventListener('click', () => filterPosts('discussion'));
            }

            // New posts indicator (feed page only)
            if (elements.newPostsIndicator) {
                elements.newPostsIndicator.addEventListener('click', () => {
                    markPostsAsViewed();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            // Onboarding buttons
            if (elements.startOnboardingBtn) elements.startOnboardingBtn.addEventListener('click', () => nextStep(2));
            if (elements.backToStep1Btn) elements.backToStep1Btn.addEventListener('click', () => prevStep());
            if (elements.continueToStep3Btn) elements.continueToStep3Btn.addEventListener('click', () => nextStep(3));
            if (elements.backToStep2Btn) elements.backToStep2Btn.addEventListener('click', () => prevStep());

            // Club selection
            document.querySelectorAll('.club-card').forEach(card => {
                card.addEventListener('click', () => {
                    const clubId = card.dataset.club;
                    toggleClubSelection(clubId);
                });
            });

            // Sign out
            if (elements.signOutOption) {
                elements.signOutOption.addEventListener('click', signOut);
            }

            // Modal close buttons
            if (elements.closeSigninModal) {
                elements.closeSigninModal.addEventListener('click', () => {
                    elements.signinModal.classList.remove('active');
                    document.body.classList.remove('modal-open');
                });
            }

            if (elements.closeNotificationsModal) {
                elements.closeNotificationsModal.addEventListener('click', () => {
                    elements.notificationsModal.classList.remove('active');
                    document.body.classList.remove('modal-open');
                });
            }

            if (elements.closeCreatePostModal) {
                elements.closeCreatePostModal.addEventListener('click', closeCreatePostModal);
            }
            if (elements.cancelCreatePostBtn) {
                elements.cancelCreatePostBtn.addEventListener('click', closeCreatePostModal);
            }
            if (elements.cancelDeleteBtn) {
                elements.cancelDeleteBtn.addEventListener('click', () => {
                    if (elements.deleteConfirmModal) {
                        elements.deleteConfirmModal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                        postToDelete = null;
                    }
                });
            }
            if (elements.confirmDeleteBtn) {
                elements.confirmDeleteBtn.addEventListener('click', deletePost);
            }

            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                        if (modal.id === 'deleteConfirmModal') {
                            postToDelete = null;
                        }
                    }
                });
            });

            // Escape key to close modals
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                        document.body.classList.remove('modal-open');
                    });
                    if (elements.deleteConfirmModal && elements.deleteConfirmModal.classList.contains('active')) {
                        postToDelete = null;
                    }
                }
            });

            // Scroll handling
            window.addEventListener('scroll', handleScroll);
            
            // Request notification permission
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        // Handle scroll
        function handleScroll() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            // Show/hide back to top button
            if (elements.backToTop) {
                if (scrollTop > 300) {
                    elements.backToTop.classList.add('visible');
                } else {
                    elements.backToTop.classList.remove('visible');
                }
            }
            
            // Hide/show bottom nav on scroll
            if (elements.bottomNav) {
                if (scrollTop > 100) {
                    elements.bottomNav.classList.add('hidden');
                } else {
                    elements.bottomNav.classList.remove('hidden');
                }
            }
        }

        // Initialize the app
        function initializeApp() {
            // Check authentication
            const isAuthenticated = checkAuthStatus();
            
            // Initialize event listeners
            initEventListeners();
            
            // Load posts if on feed page
            if (elements.postsContainer) {
                loadPosts();
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Make functions available globally
        window.handleGoogleSignIn = handleGoogleSignIn;
        window.openCreatePostModal = openCreatePostModal;
        window.closeCreatePostModal = closeCreatePostModal;
        window.confirmDeletePost = confirmDeletePost;
        window.toggleComments = toggleComments;
        window.submitComment = submitComment;
        window.handlePostAction = handlePostAction;
        window.togglePostOptions = togglePostOptions;
        window.showPostInsights = showPostInsights;
        window.nextStep = nextStep;
        window.prevStep = prevStep;
        window.toggleClubSelection = toggleClubSelection;
        window.filterPosts = filterPosts;
        window.removeTag = removeTag;
        window.viewImage = viewImage;
        window.viewNotification = viewNotification;
    </script>
</body>
</html>
